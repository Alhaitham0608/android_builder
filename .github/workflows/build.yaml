name: android_build  
  
on:  
  workflow_dispatch:  
  
jobs:  
  build:  
    runs-on: ubuntu-latest  
    steps:  
      - name: Checkout the code  
        uses: actions/checkout@v3  
  
      - name: Set up JDK  
        uses: actions/setup-java@v3  
        with:  
          java-version: '8' # 使用更通用的方式指定Java 8  
          distribution: 'adopt'  
  
      - name: Get project name  
        id: get-project  
        run: echo "::set-output name=PROJECT::$(cat project-to-build)"  
  
      - name: Clone project  
        run: git clone --depth=1 https://github.com/${{ steps.get-project.outputs.PROJECT }}.git project  
  
      - name: Build the app  
        working-directory: ./project  
        run: |  
          chmod +x gradlew  
          ./gradlew assembleDebug --stacktrace  
   
      - name: Upload APK  
        if: success()  
        uses: actions/upload-artifact@v3  
        with:  
          name: my-build-apk  
          path: ./project/**/*.apk
